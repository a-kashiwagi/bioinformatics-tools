/* -*- Mode: C; indent-tabs-mode: t; c-basic-offset: 8; tab-width: 8 -*- */
/*
 * main.c
 *
 * Generated anjuta and glade. and writed by Kashiwagi Akihiro.
 *
 * Copyright (C) Kashiwagi Akihiro 2010 <a-kashiwagi@mippi-mail.com>
 * 
 * LCS is free software and shareware : you can redistribute it and/or
 * modify it under the terms of the GNU General Public License as published
 * by the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version. and you must pay 10[%] part of profit
 * to me that case of you used this software for business.
 * 
 * lcs_gui is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License along
 * with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#include <sys/types.h>
#include <sys/stat.h>
#include <unistd.h>
#include <string.h>
#include <ctype.h>
#include <stdio.h>

#include <config.h>

#include <gtk/gtk.h>
#include "lcs.h"

/*
 * Standard gettext macros.
 */
#ifdef ENABLE_NLS
#  include <libintl.h>
#  undef _
#  define _(String) dgettext (PACKAGE, String)
#  ifdef gettext_noop
#    define N_(String) gettext_noop (String)
#  else
#    define N_(String) (String)
#  endif
#else
#  define textdomain(String) (String)
#  define gettext(String) (String)
#  define dgettext(Domain,Message) (Message)
#  define dcgettext(Domain,Message,Type) (Message)
#  define bindtextdomain(Domain,Directory) (Domain)
#  define _(String) (String)
#  define N_(String) (String)
#endif



#include "callbacks.h"

//For testing propose use the local (not installed) ui file
#define UI_FILE PACKAGE_DATA_DIR"/lcs/ui/lcs_gui.ui"
//#define UI_FILE "src/lcs_gui.ui"

GtkWidget *create_window ( void );
long clean_up_sequence( char *sequence );
int set_tags_to_textbuffer( GtkTextBuffer *textbuf );
int put_sequence(
        GtkTextBuffer *textbuf,
        char ch,
        long eg,
        int compare_mode
);
int PrintOutForTextViwe(
	char *v,
	char *w,
	char **eg,
	long **ss,
	char **bp,
	char *v_ans,
	char *w_ans,
	char *ans,
	char *eg_arr,
	long *ss_arr,
	char *bp_arr,
	long  inum,
	long  jnum,
	long  vnum,
	long  wnum,
	long  ansnum,
	long  egnum,
	long  ssnum,
	long  bpnum,
	long  v_lc_from,
	long  v_lc_to,
	long  w_lc_from,
	long  w_lc_to,
        long  ident_cnt,
        double ident_rate,
        long score,
        int   compare_mode
);

					/* declare pointer of each object     */
					/*                in created builder  */
GtkWidget *vbox1;
GtkWidget *hbox1;
GtkWidget *scrolledwindow1;
GtkWidget *scrolledwindow2;
GtkWidget *textview1;
GtkTextBuffer *textbuf1;
GtkWidget *textview2;
GtkTextBuffer *textbuf2;
GtkWidget *textview3;
GtkTextBuffer *textbuf3;
GtkWidget *textview4;
GtkTextBuffer *textbuf4;
GtkWidget *textview5;
GtkTextBuffer *textbuf5;
GtkWidget *textview6;
GtkTextBuffer *textbuf6;
GtkWidget *textview7;
GtkTextBuffer *textbuf7;
GtkWidget *textview8;
GtkTextBuffer *textbuf8;
GtkWidget *comparetype0_radio;
GtkWidget *comparetype1_radio;
GtkWidget *comparemode0_radio;
GtkWidget *comparemode1_radio;
GtkWidget *alignmentmode0_radio;
GtkWidget *alignmentmode1_radio;
GtkWidget *gapscoremode0_radio;
GtkWidget *gapscoremode1_radio;
GtkWidget *label1;
GtkWidget *label2;
GtkWidget *Location_label;
GtkWidget *Rate_label;
GtkWidget *Score_label;
GtkWidget *e_num_spin;
GtkWidget *d_num_spin;
GtkWidget *match_num_spin;
GtkWidget *unmatch_num_spin;
GtkWidget *adjustment1;
GtkWidget *adjustment2;
GtkWidget *adjustment3;
GtkWidget *adjustment4;

/******************************************************************************/
/*                                                                            */
/* Title  : Create window                                                     */
/* Function Name : create_window                                              */
/*                                                                            */
/* Detail : Create                                                            */
/* Date   : 2010/09/16                                                        */
/* Author : Akihiro Kashiwagi                                                 */
/* e-mail : a-kashiwagi@mippi-mail.com                                        */
/*                                                                            */
/* Input  : void                                                              */
/* Output : GtkWidget *window : Pointer of window                             */
/*                                                                            */
/* Replace -------------------------------------------------------------------*/
/*                                                                            */
/* Date   :                                                                   */
/* Author :                                                                   */
/* Deteil :                                                                   */
/*                                                                            */
/*-------+---------+---------+---------+---------+---------+---------+--------*/
/*3456789012345678901234567890123456789012345678901234567890123456789012345678*/
/******************************************************************************/

GtkWidget*
create_window (	void )
{
	GtkWidget *window;
	GtkBuilder *builder;
	GError* error = NULL;
	GtkTextBuffer *textbuf;
	PangoFontDescription *font_desc;

	builder = gtk_builder_new ();
	if (!gtk_builder_add_from_file (builder, UI_FILE, &error))
	{
		g_warning ("Couldn't load builder file: %s", error->message);
		g_error_free (error);
	}

	/* This is important */
	gtk_builder_connect_signals (builder, NULL);

					/* Get each object                    */
					/*             in created by builder  */

					/* Get window object                  */
	window = GTK_WIDGET (gtk_builder_get_object (builder, "window"));

					/* Get vbox1 object                   */
	vbox1 = GTK_WIDGET (gtk_builder_get_object (builder, "vbox1"));

					/* Get hbox1 object                   */
	hbox1 = GTK_WIDGET (gtk_builder_get_object (builder, "hbox1"));

					/* Get scrolledwindow1 object         */
	scrolledwindow1 = GTK_WIDGET (
	    gtk_builder_get_object (builder, "scrolledwindow1")
	);
					/* Get scrolledwindow2 object         */
	scrolledwindow2 = GTK_WIDGET (
	    gtk_builder_get_object (builder, "scrolledwindow2")
	);
					/* Get textview1 object               */
	textview1 = GTK_WIDGET (gtk_builder_get_object (builder, "textview1"));

					/* Get textview2 object               */
	textview2 = GTK_WIDGET (gtk_builder_get_object (builder, "textview2"));

					/* Get textview3 object               */
	textview3 = GTK_WIDGET (gtk_builder_get_object (builder, "textview3"));

					/* Get textview4 object               */
	textview4 = GTK_WIDGET (gtk_builder_get_object (builder, "textview4"));

					/* Get textview5 object               */
	textview5 = GTK_WIDGET (gtk_builder_get_object (builder, "textview5"));

					/* Get textview6 object               */
	textview6 = GTK_WIDGET (gtk_builder_get_object (builder, "textview6"));

					/* Get textview7 object               */
	textview7 = GTK_WIDGET (gtk_builder_get_object (builder, "textview7"));

					/* Get textview8 object               */
	textview8 = GTK_WIDGET (gtk_builder_get_object (builder, "textview8"));

					/* Get comparetype0 object            */
	comparetype0_radio = GTK_WIDGET (
	    gtk_builder_get_object (builder, "comparetype0")
	);
					/* Get comparetype1 object            */
	comparetype1_radio = GTK_WIDGET (
	    gtk_builder_get_object (builder, "comparetype1")
	);
					/* Get comparemode0 object            */
	comparemode0_radio = GTK_WIDGET (
	    gtk_builder_get_object (builder, "comparemode0")
	);
					/* Get comparemode1 object            */
	comparemode1_radio = GTK_WIDGET (
	    gtk_builder_get_object (builder, "comparemode1")
	);
					/* Get alignmentmode0 object          */
	alignmentmode0_radio = GTK_WIDGET (
	    gtk_builder_get_object (builder, "alignmentmode0")
	);
					/* Get alignmentmode1 object          */
	alignmentmode1_radio = GTK_WIDGET (
	    gtk_builder_get_object (builder, "alignmentmode1")
	);
					/* Get gapmode1 object                */
	gapscoremode1_radio = GTK_WIDGET (
	    gtk_builder_get_object (builder, "gapmode1")
	);
					/* Get gapmode0 object                */
	gapscoremode0_radio = GTK_WIDGET (
	    gtk_builder_get_object (builder, "gapmode0")
	);
					/* Get label1 object                  */
	label1 = GTK_WIDGET (gtk_builder_get_object (builder, "label1"));

					/* Get label2 object                  */
	label2 = GTK_WIDGET (gtk_builder_get_object (builder, "label2"));

					/* Get Location object                */
	Location_label = GTK_WIDGET (
	        gtk_builder_get_object (builder, "Location")
	);
					/* Get Rate object                    */
	Rate_label = GTK_WIDGET (gtk_builder_get_object (builder, "Rate"));

					/* Get Score object                   */
	Score_label = GTK_WIDGET (gtk_builder_get_object (builder, "Score"));

					/* Get e_num object                   */
	e_num_spin = GTK_WIDGET (
	        gtk_builder_get_object (builder, "e_num")
	);
					/* Get d_num object                   */
	d_num_spin = GTK_WIDGET (
	        gtk_builder_get_object (builder, "d_num")
	);
					/* Get match_num object               */
	match_num_spin = GTK_WIDGET (
	        gtk_builder_get_object (builder, "match_num")
	);
					/* Get unmatch_num object             */
	unmatch_num_spin = GTK_WIDGET (
	        gtk_builder_get_object (builder, "unmatch_num")
	);
					/* Get adjustment1 object             */
	adjustment1 = GTK_WIDGET (
	        gtk_builder_get_object (builder, "adjustment1")
	);
					/* Get adjustment2 object             */
	adjustment2 = GTK_WIDGET (
	        gtk_builder_get_object (builder, "adjustment2")
	);
					/* Get adjustmnet3 object             */
	adjustment3 = GTK_WIDGET (
	        gtk_builder_get_object (builder, "adjustment3")
	);
					/* Get adjustment4 object             */
	adjustment4 = GTK_WIDGET (
	        gtk_builder_get_object (builder, "adjustment4")
	);
					/* Set object to callback area too    */
	set_objects_to_callback_area( GTK_BUILDER(builder) );
					/* Set value to spin button e_num     */
	gtk_spin_button_set_value( GTK_SPIN_BUTTON( e_num_spin ), (gdouble)5 );
					/* Set value to spin button d_num     */
	gtk_spin_button_set_value( GTK_SPIN_BUTTON( d_num_spin ), (gdouble)10 );
					/* Set value to spin button match_num */
	gtk_spin_button_set_value(
		GTK_SPIN_BUTTON( match_num_spin ), (gdouble)10
	);
					/* Set value to spin button           */
					/*                      unmatch_num   */
	gtk_spin_button_set_value(
	        GTK_SPIN_BUTTON( unmatch_num_spin ), (gdouble)0
	);
					/* TextBuffer get from textview1      */
	textbuf1 = gtk_text_view_get_buffer( GTK_TEXT_VIEW(textview1) );
					/* Set tags to textview1              */
	set_tags_to_textbuffer( textbuf1 );
					/* Set callback function              */
					/*           when after signal        */
	g_signal_connect_after(
	        G_OBJECT(textbuf1),
	        "insert-text",
	        G_CALLBACK( on_textbuf_insert ),
	        NULL
	);

					/* TextBuffer get from textview2      */
	textbuf2 = gtk_text_view_get_buffer( GTK_TEXT_VIEW(textview2) );
					/* Set tags to textview2              */
	set_tags_to_textbuffer( textbuf2 );
					/* Set callback function              */
					/*           when after signal        */
	g_signal_connect_after(
	        G_OBJECT(textbuf2),
	        "insert-text",
	        G_CALLBACK( on_textbuf_insert ),
	        NULL
	);
	
					/* TextBuffer get from textview3      */
	textbuf3 = gtk_text_view_get_buffer( GTK_TEXT_VIEW(textview3) );
					/* Set tags to textview3              */
	set_tags_to_textbuffer( textbuf3 );
					/* Set callback function              */
					/*           when after signal        */
	g_signal_connect_after(
	        G_OBJECT(textbuf3),
	        "insert-text",
	        G_CALLBACK( on_textbuf_insert ),
	        NULL
	);
	
					/* TextBuffer get from textview4      */
	textbuf4 = gtk_text_view_get_buffer( GTK_TEXT_VIEW(textview4) );
					/* Set tags to textview4              */
	set_tags_to_textbuffer( textbuf4 );
	
					/* TextBuffer get from textview5      */
	textbuf5 = gtk_text_view_get_buffer( GTK_TEXT_VIEW(textview5) );
					/* Set tags to textview5              */
	set_tags_to_textbuffer( textbuf5 );
	
					/* TextBuffer get from textview6      */
	textbuf6 = gtk_text_view_get_buffer( GTK_TEXT_VIEW(textview6) );
					/* Set tags to textview6              */
	set_tags_to_textbuffer( textbuf6 );
	
					/* TextBuffer get from textview7      */
	textbuf7 = gtk_text_view_get_buffer( GTK_TEXT_VIEW(textview7) );
					/* Set tags to textview7              */
	set_tags_to_textbuffer( textbuf7 );
	
					/* TextBuffer get from textview8      */
	textbuf8 = gtk_text_view_get_buffer( GTK_TEXT_VIEW(textview8) );
					/* Set tags to textview8              */
	set_tags_to_textbuffer( textbuf8 );

					/* Set wedget fonts                   */
	font_desc = pango_font_description_from_string("Courier 10 Pitch 10");
	gtk_widget_modify_font(textview1, font_desc);
	gtk_widget_modify_font(textview2, font_desc);
	gtk_widget_modify_font(textview3, font_desc);
	gtk_widget_modify_font(textview4, font_desc);
	gtk_widget_modify_font(textview5, font_desc);
	gtk_widget_modify_font(textview6, font_desc);
	gtk_widget_modify_font(textview7, font_desc);
	gtk_widget_modify_font(textview8, font_desc);
	pango_font_description_free( font_desc );
/*
	font_desc = pango_font_description_from_string("Times New Roman 10");
	gtk_widget_modify_font(comparetype0_radio, font_desc);
	gtk_widget_modify_font(comparetype1_radio, font_desc);
	gtk_widget_modify_font(comparemode0_radio, font_desc);
	gtk_widget_modify_font(comparemode1_radio, font_desc);
	gtk_widget_modify_font(alignmentmode0_radio, font_desc);
	gtk_widget_modify_font(alignmentmode1_radio, font_desc);
	gtk_widget_modify_font(gapscoremode0_radio, font_desc);
	gtk_widget_modify_font(gapscoremode1_radio, font_desc);
	gtk_widget_modify_font(label1, font_desc);
	gtk_widget_modify_font(label2, font_desc);
	gtk_widget_modify_font(Location_label, font_desc);
	gtk_widget_modify_font(Rate_label, font_desc);
	gtk_widget_modify_font(Score_label, font_desc);
	gtk_widget_modify_font(e_num_spin, font_desc);
	gtk_widget_modify_font(d_num_spin, font_desc);
	gtk_widget_modify_font(match_num_spin, font_desc);
	gtk_widget_modify_font(unmatch_num_spin, font_desc);
	pango_font_description_free( font_desc );
*/
					/* Unreference builder object         */
	g_object_unref (builder);
	
	return window;
}

/******************************************************************************/
/*                                                                            */
/* Title  : Clean up sequence                                                 */
/* Function Name : clean_up_sequence()                                        */
/*                                                                            */
/* Detail : Create                                                            */
/* Date   : 2010/09/30                                                        */
/* Author : Akihiro Kashiwagi                                                 */
/* e-mail : a-kashiwagi@mippi-mail.com                                        */
/*                                                                            */
/* Input  : char *sequence : Pointer of sequence string                       */
/* Output : long           : Location of end of cleanuped sequence string     */
/*                                                                            */
/* Replace -------------------------------------------------------------------*/
/*                                                                            */
/* Date   :                                                                   */
/* Author :                                                                   */
/* Deteil :                                                                   */
/*                                                                            */
/*-------+---------+---------+---------+---------+---------+---------+--------*/
/*3456789012345678901234567890123456789012345678901234567890123456789012345678*/
/******************************************************************************/

long clean_up_sequence( char *sequence ){

	long seq_cnt;
					/* Count of input sequence            */
	long cls_cnt;
					/* Count of cleanuped sequence        */

					/* Counter reset                      */
	seq_cnt = 0;
	cls_cnt = 0;

					/* Loop of sequence                   */
	while( sequence[seq_cnt] != '\0' ){

		if( isspace(sequence[seq_cnt]) ){
					/* Case of LF when continue           */
			seq_cnt++;
			continue;

		}else if( sequence[seq_cnt] == '>' ){
					/* Case of Fasta header               */

			while( sequence[seq_cnt] != '\n' ){
					/* Counter forward until LF           */
				seq_cnt++;
			}
			seq_cnt++;

			continue;
		}
					/* Copy to cleanuped sequence         */
					/*      from input sequence           */
		sequence[cls_cnt] = sequence[seq_cnt];

					/* Counter increment                  */
		cls_cnt++;
		seq_cnt++;
	}
					/* Insert null terminater             */
	sequence[cls_cnt] = '\0';
					/* Retuern cleanuped sequence length  */
	return( cls_cnt );
}

/******************************************************************************/
/*                                                                            */
/* Title  : Set tags to text buffer                                           */
/* Function Name : set_tags_to_textbuffer                                     */
/*                                                                            */
/* Detail : Create                                                            */
/* Date   : 2010/09/16                                                        */
/* Author : Akihiro Kashiwagi                                                 */
/* e-mail : a-kashiwagi@mippi-mail.com                                        */
/*                                                                            */
/* Input  : GtkTextBuffer *textbuf : Pointer of text buffer                   */
/* Output : GtkTextBuffer *        : Pointer of modifyed text buffer          */
/*                                                                            */
/* Replace -------------------------------------------------------------------*/
/*                                                                            */
/* Date   : 2010/10/08                                                        */
/* Author : Akihiro Kashiwagi                                                 */
/* Deteil : Added tag that is background color.                               */
/*                                                                            */
/* Date   :                                                                   */
/* Author :                                                                   */
/* Deteil :                                                                   */
/*                                                                            */
/*-------+---------+---------+---------+---------+---------+---------+--------*/
/*3456789012345678901234567890123456789012345678901234567890123456789012345678*/
/******************************************************************************/

int set_tags_to_textbuffer( GtkTextBuffer *textbuf ){

					/* Nucleotide Acid                    */

					/* Create tag for Adenine(red)        */
	gtk_text_buffer_create_tag(
		textbuf, "Adenine",
		"foreground", "#FF0000",
		NULL
	);
					/* Create tag for Thymine(green)      */
	gtk_text_buffer_create_tag(
		textbuf, "Thymine",
		"foreground", "#00FF00",
		NULL
	);
					/* Create tag for Guanine(blue)       */
	gtk_text_buffer_create_tag(
		textbuf, "Guanine",
		"foreground", "#0000FF",
		NULL
	);
					/* Create tag for Cytosine(purple)    */
	gtk_text_buffer_create_tag(
		textbuf, "Cytosine",
		"foreground", "#7F007F",
		NULL
	);

					/* Amino Acid                         */

					/*    Hydrophilic                     */

					/*        Basic(yellow)               */

					/* Create tag for R:Arginine          */
	gtk_text_buffer_create_tag(
		textbuf, "Arginine",
		"foreground", "#FF8000",
		NULL
	);
					/* Create tag for K:Lysine            */
	gtk_text_buffer_create_tag(
		textbuf, "Lysine",
		"foreground", "#FFBB00",
		NULL
	);
					/* Create tag for H:Histidine         */
	gtk_text_buffer_create_tag(
		textbuf, "Histidine",
		"foreground", "#FFFF00",
		NULL
	);
					/*        Acidic(brown)               */

					/* Create tag for D:AsparagineAcid    */
	gtk_text_buffer_create_tag(
		textbuf, "AsparagineAcid",
		"foreground", "#800000",
		NULL
	);
					/* Create tag for E:GlutamicAcid      */
	gtk_text_buffer_create_tag(
		textbuf, "GlutamicAcid",
		"foreground", "#400000",
		NULL
	);
					/*        Neutral Polar(green)        */

					/* Create tag for N:Asparagine        */
	gtk_text_buffer_create_tag(
		textbuf, "Asparagine",
		"foreground", "#80FF80",
		NULL
	);
					/* Create tag for Q:Glutamine         */
	gtk_text_buffer_create_tag(
		textbuf, "Glutamine",
		"foreground", "#80FF00",
		NULL
	);
					/* Create tag for S:Serine            */
	gtk_text_buffer_create_tag(
		textbuf, "Serine",
		"foreground", "#008000",
		NULL
	);
					/* Create tag for T:Threonine         */
	gtk_text_buffer_create_tag(
		textbuf, "Threonine",
		"foreground", "#80FFFF",
		NULL
	);
					/* Create tag for Y:Tyrosine          */
	gtk_text_buffer_create_tag(
		textbuf, "Tyrosine",
		"foreground", "#004000",
		NULL
	);
					/* Hydrophobic(blue,purple,red)       */

					/* Create tag for G:Glycine           */
	gtk_text_buffer_create_tag(
		textbuf, "Glycine",
		"foreground", "#00FF00",
		NULL
	);
					/* Create tag for F:Phenylalane       */
	gtk_text_buffer_create_tag(
		textbuf, "Phenylalane",
		"foreground", "#008080",
		NULL
	);
					/* Create tag for L:Leucine           */
	gtk_text_buffer_create_tag(
		textbuf, "Leucine",
		"foreground", "#8080FF",
		NULL
	);
					/* Create tag for C:Cysteine          */
	gtk_text_buffer_create_tag(
		textbuf, "Cysteine",
		"foreground", "#7F007F",
		NULL
	);
					/* Create tag for W:Tryptophan        */
	gtk_text_buffer_create_tag(
		textbuf, "Tryptophan",
		"foreground", "#8000FF",
		NULL
	);
					/* Create tag for P:Proline           */
	gtk_text_buffer_create_tag(
		textbuf, "Proline",
		"foreground", "#800080",
		NULL
	);
					/* Create tag for I:Isoleucine        */
	gtk_text_buffer_create_tag(
		textbuf, "Isoleucine",
		"foreground", "#808080",
		NULL
	);
					/* Create tag for A:Alanine           */
	gtk_text_buffer_create_tag(
		textbuf, "Alanine",
		"foreground", "#FF0000",
		NULL
	);
					/* Create tag for M:Methionine        */
	gtk_text_buffer_create_tag(
		textbuf, "Methionine",
		"foreground", "#FF80FF",
		NULL
	);
					/* Create tag for V:Valine            */
	gtk_text_buffer_create_tag(
		textbuf, "Valine",
		"foreground", "#FF8080",
		NULL
	);
					/* Create tag for Normal(black)       */
	gtk_text_buffer_create_tag(
		textbuf, "Normal",
		"foreground", "#000000",
		NULL
	);
					/* Create tag for Background -15      */
	gtk_text_buffer_create_tag(
		textbuf, "-15",
		"background", "#D000FF",
		NULL
	);
					/* Create tag for Background -14      */
	gtk_text_buffer_create_tag(
		textbuf, "-14",
		"background", "#B000FF",
		NULL
	);
					/* Create tag for Background -13      */
	gtk_text_buffer_create_tag(
		textbuf, "-13",
		"background", "#9000FF",
		NULL
	);
					/* Create tag for Background -12      */
	gtk_text_buffer_create_tag(
		textbuf, "-12",
		"background", "#7000FF",
		NULL
	);
					/* Create tag for Background -11      */
	gtk_text_buffer_create_tag(
		textbuf, "-11",
		"background", "#5000FF",
		NULL
	);
					/* Create tag for Background -10      */
	gtk_text_buffer_create_tag(
		textbuf, "-10",
		"background", "#3000FF",
		NULL
	);
					/* Create tag for Background -9       */
	gtk_text_buffer_create_tag(
		textbuf, "-9",
		"background", "#1000FF",
		NULL
	);
					/* Create tag for Background -8       */
	gtk_text_buffer_create_tag(
		textbuf, "-8",
		"background", "#000FFF",
		NULL
	);
					/* Create tag for Background -7       */
	gtk_text_buffer_create_tag(
		textbuf, "-7",
		"background", "#002FFF",
		NULL
	);
					/* Create tag for Background -6       */
	gtk_text_buffer_create_tag(
		textbuf, "-6",
		"background", "#004FFF",
		NULL
	);
					/* Create tag for Background -5       */
	gtk_text_buffer_create_tag(
		textbuf, "-5",
		"background", "#006FFF",
		NULL
	);
					/* Create tag for Background -4       */
	gtk_text_buffer_create_tag(
		textbuf, "-4",
		"background", "#008FFF",
		NULL
	);
					/* Create tag for Background -3       */
	gtk_text_buffer_create_tag(
		textbuf, "-3",
		"background", "#00AFFF",
		NULL
	);
					/* Create tag for Background -2       */
	gtk_text_buffer_create_tag(
		textbuf, "-2",
		"background", "#00BFFF",
		NULL
	);
					/* Create tag for Background -1       */
	gtk_text_buffer_create_tag(
		textbuf, "-1",
		"background", "#00DFFF",
		NULL
	);
					/* Create tag for Background  0       */
	gtk_text_buffer_create_tag(
		textbuf, "0",
		"background", "#00FFFF",
		NULL
	);
					/* Create tag for Background  1       */
	gtk_text_buffer_create_tag(
		textbuf, "1",
		"background", "#00FFD0",
		NULL
	);
					/* Create tag for Background  2       */
	gtk_text_buffer_create_tag(
		textbuf, "2",
		"background", "#00FFB0",
		NULL
	);
					/* Create tag for Background  3       */
	gtk_text_buffer_create_tag(
		textbuf, "3",
		"background", "#00FF90",
		NULL
	);
					/* Create tag for Background  4       */
	gtk_text_buffer_create_tag(
		textbuf, "4",
		"background", "#00FF70",
		NULL
	);
					/* Create tag for Background  5       */
	gtk_text_buffer_create_tag(
		textbuf, "5",
		"background", "#00FF50",
		NULL
	);
					/* Create tag for Background  6       */
	gtk_text_buffer_create_tag(
		textbuf, "6",
		"background", "#00FF30",
		NULL
	);
					/* Create tag for Background  7       */
	gtk_text_buffer_create_tag(
		textbuf, "7",
		"background", "#00FF10",
		NULL
	);
					/* Create tag for Background  8       */
	gtk_text_buffer_create_tag(
		textbuf, "8",
		"background", "#10FF00",
		NULL
	);
					/* Create tag for Background  9       */
	gtk_text_buffer_create_tag(
		textbuf, "9",
		"background", "#30FF00",
		NULL
	);
					/* Create tag for Background 10       */
	gtk_text_buffer_create_tag(
		textbuf, "10",
		"background", "#50FF00",
		NULL
	);
					/* Create tag for Background 11       */
	gtk_text_buffer_create_tag(
		textbuf, "11",
		"background", "#70FF00",
		NULL
	);
					/* Create tag for Background 12       */
	gtk_text_buffer_create_tag(
		textbuf, "12",
		"background", "#90FF00",
		NULL
	);
					/* Create tag for Background 13       */
	gtk_text_buffer_create_tag(
		textbuf, "13",
		"background", "#B0FF00",
		NULL
	);
					/* Create tag for Background 14       */
	gtk_text_buffer_create_tag(
		textbuf, "14",
		"background", "#D0FF00",
		NULL
	);
					/* Create tag for Background 15       */
	gtk_text_buffer_create_tag(
		textbuf, "15",
		"background", "#FFFF00",
		NULL
	);
					/* Create tag for Number              */
	gtk_text_buffer_create_tag(
		textbuf, "NUMBER",
		"foreground", "#666666",
		"background", "#CCCCCC",
		NULL
	);
					/* Return with *textbuf               */
	return( textbuf );
}

/******************************************************************************/
/*                                                                            */
/* Title  : Put sequence character to text buffer with tag                    */
/* Function Name : put_sequence                                               */
/*                                                                            */
/* Detail : Create                                                            */
/* Date   : 2010/09/16                                                        */
/* Author : Akihiro Kashiwagi                                                 */
/* e-mail : a-kashiwagi@mippi-mail.com                                        */
/*                                                                            */
/* Input  : GtkTextBuffer *textbuf : Pointer of text buffer                   */
/*        : char ch                : Character for ouotput                    */
/*        : long eg                : Character for ouotput                    */
/*        : int  compare_mode      : Sequence compare mode                    */
/*                                                                            */
/* Output : int : NormalTerminate [0]                                         */
/*                                                                            */
/* Replace -------------------------------------------------------------------*/
/*                                                                            */
/* Date   : 2010/10/08                                                        */
/* Author : Akihiro Kashiwagi                                                 */
/* Deteil : Added procedure that is score chromatography :-)                  */
/*                                                                            */
/* Date   :                                                                   */
/* Author :                                                                   */
/* Deteil :                                                                   */
/*                                                                            */
/*-------+---------+---------+---------+---------+---------+---------+--------*/
/*3456789012345678901234567890123456789012345678901234567890123456789012345678*/
/******************************************************************************/

int put_sequence(
        GtkTextBuffer *textbuf,
        char ch,
        long eg,
        int compare_mode
){

					/* Buffer for output                  */
	char buf[4];
					/* Forground  Tagname for output      */
	char fgtagname[20];
					/* Background Tagname for output      */
	char bgtagname[20];
					/* Iterator of current cursor         */
	GtkTextIter cur;

					/* Set tag name                       */
	switch(ch){
					/* for Adenine                        */
		case 'A':
			strcpy( fgtagname, "Adenine");
			break;
					/* for Thymine                        */
		case 'T':
			strcpy( fgtagname, "Thymine");
			break;
					/* for Guanine                        */
		case 'G':
			strcpy( fgtagname, "Guanine");
			break;
					/* for Cytosine                       */
		case 'C':
			strcpy( fgtagname, "Cytosine");
			break;
					/* Set tag name of Phenylalane       */
		case 'F':
			strcpy( fgtagname, "Phenylalane");
			break;
					/* Set tag name of Leucine           */
		case 'L':
			strcpy( fgtagname, "Leucine");
			break;
					/* Set tag name of Serine            */
		case 'S':
			strcpy( fgtagname, "Serine");
			break;
					/* Set tag name of Tyrosine          */
		case 'Y':
			strcpy( fgtagname, "Tyrosine");
			break;
					/* Set tag name of Cysteine          */
		/*
		case 'C':
			strcpy( fgtagname, "Cysteine");
			break;
		*/
					/* Set tag name of Tryptophan        */
		case 'W':
			strcpy( fgtagname, "Tryptophan");
			break;
					/* Set tag name of Proline           */
		case 'P':
			strcpy( fgtagname, "Proline");
			break;
					/* Set tag name of Histidine         */
		case 'H':
			strcpy( fgtagname, "Histidine");
			break;
					/* Set tag name of Glutamine         */
		case 'Q':
			strcpy( fgtagname, "Glutamine");
			break;
					/* Set tag name of Arginine          */
		case 'R':
			strcpy( fgtagname, "Arginine");
			break;
					/* Set tag name of Isoleucine        */
		case 'I':
			strcpy( fgtagname, "Isoleucine");
			break;
					/* Set tag name of Methionine        */
		case 'M':
			strcpy( fgtagname, "Methionine");
			break;
					/* Set tag name of Threonine         */
		/*
		case 'T':
			strcpy( fgtagname, "Threonine");
			break;
		*/
					/* Set tag name of Asparagine        */
		case 'N':
			strcpy( fgtagname, "Asparagine");
			break;
					/* Set tag name of Lysine            */
		case 'K':
			strcpy( fgtagname, "Lysine");
			break;
					/* Set tag name of Valine            */
		case 'V':
			strcpy( fgtagname, "Valine");
			break;
					/* Set tag name of Alanine           */
		/*
		case 'A':
			strcpy( fgtagname, "Alanine");
			break;
		*/
					/* Set tag name of AsparagineAcid    */
		case 'D':
			strcpy( fgtagname, "AsparagineAcid");
			break;
					/* Set tag name of GlutamicAcid      */
		case 'E':
			strcpy( fgtagname, "GlutamicAcid");
			break;
					/* Set tag name of Glycine           */
		/*
		case 'G':
			strcpy( fgtagname, "Glycine");
			break;
		*/
					/* for Other                          */
		default:
			strcpy( fgtagname, "Normal");
			break;
	}
					/* Set background color               */

	if( compare_mode == NUCLEOTIDE ){
					/* Case of Nucleotide mode            */
					/*            Adjustment eg score     */
		if( eg == 999 ){

			eg = 999;

		}else if( eg == 0 ){

			eg = 0;

		}else if( eg < 0 ){

			eg = -13;

		}else if( eg > 0 ){

			eg = 13;
		}
	}
					/* Case of Amino Acid mode            */
	switch( eg ){

		case -15:
			strcpy( bgtagname, "-15" );
			break;

		case -14:
			strcpy( bgtagname, "-14" );
			break;

		case -13:
			strcpy( bgtagname, "-13" );
			break;

		case -12:
			strcpy( bgtagname, "-12" );
			break;

		case -11:
			strcpy( bgtagname, "-11" );
			break;

		case -10:
			strcpy( bgtagname, "-10" );
			break;

		case -9:
			strcpy( bgtagname, "-9" );
			break;

		case -8:
			strcpy( bgtagname, "-8" );
			break;

		case -7:
			strcpy( bgtagname, "-7" );
			break;

		case -6:
			strcpy( bgtagname, "-6" );
			break;

		case -5:
			strcpy( bgtagname, "-5" );
			break;

		case -4:
			strcpy( bgtagname, "-4" );
			break;

		case -3:
			strcpy( bgtagname, "-3" );
			break;

		case -2:
			strcpy( bgtagname, "-2" );
			break;

		case -1:
			strcpy( bgtagname, "-2" );
			break;

		case 0:
			strcpy( bgtagname, "0" );
			break;

		case 1:
			strcpy( bgtagname, "1" );
			break;

		case 2:
			strcpy( bgtagname, "2" );
			break;

		case 3:
			strcpy( bgtagname, "3" );
			break;

		case 4:
			strcpy( bgtagname, "4" );
			break;

		case 5:
			strcpy( bgtagname, "5" );
			break;

		case 6:
			strcpy( bgtagname, "6" );
			break;

		case 7:
			strcpy( bgtagname, "7" );
			break;

		case 8:
			strcpy( bgtagname, "8" );
			break;

		case 9:
			strcpy( bgtagname, "9" );
			break;

		case 10:
			strcpy( bgtagname, "10" );
			break;

		case 11:
			strcpy( bgtagname, "11" );
			break;

		case 12:
			strcpy( bgtagname, "12" );
			break;

		case 13:
			strcpy( bgtagname, "13" );
			break;

		case 14:
			strcpy( bgtagname, "14" );
			break;

		case 15:
			strcpy( bgtagname, "15" );
			break;

		default:
			strcpy( bgtagname, "" );
			break;
	}


					/* Set buffer                         */
	sprintf( buf, "%c", ch );
					/* Get end iterator                   */
	gtk_text_buffer_get_end_iter( textbuf, &cur );

					/* Put character with tag             */
	gtk_text_buffer_insert_with_tags_by_name(
	        textbuf, &cur, buf, strlen(buf),
	        fgtagname,
	        bgtagname,
	        NULL
	);
					/* Return normal terminate            */
	return(0);
}

/* Function for test */
int put_message( char *str ){

	gtk_text_buffer_insert_at_cursor( textbuf3, str, strlen(str) );
}

/******************************************************************************/
/*                                                                            */
/* Title  : Print out for text view                                           */
/* Function Name : PrintOutForTextView()                                      */
/*                                                                            */
/* Detail :                                                                   */
/* Date   : 2010/09/10                                                        */
/* Author : Akihiro Kashiwagi                                                 */
/* E-mail : a-kashiwagi@mippi-mail.com                                        */
/*                                                                            */
/* Input  :                                                                   */
/*          char **eg      : Buffer of Edit Graph                             */
/*          long **ss      : Buffer of Similary Score                         */
/*          char **bp      : Buffer of Back Tracking                          */
/*          char *v_ans    : Answer of calculation of v                       */
/*          char *w_ans    : Answer of calcularion of w                       */
/*          char *ans      : Answer of LCS                                    */
/*          char *eg_arr   : Buffer of Edit graph pointer                     */
/*          long *ss_arr   : Buffer of Similary score pointer                 */
/*          char *bp_arr   : Buffer of Back tracking pointer                  */
/*          long  inum     : Number of i array                                */
/*          long  jnum     : Number of j array                                */
/*          long  vnum     : Number of w array                                */
/*          long  wnum     : Number of w array                                */
/*          long  ansnum   : Number of anser array                            */
/*          long  egnum    : Number of Edit graph arrary                      */
/*          long  ssnum    : Number of Similary score arrary                  */
/*          long  bpnum    : Number of back tracking arrary                   */
/*          long  v_lc_from: location number of v sequence at start           */
/*          long  v_lc_to  : location number of v sequence at end             */
/*          long  w_lc_from: location number of w sequence at start           */
/*          long  w_lc_to  : location number of v sequence at end             */
/*          long   ident_cnt  : Count of identities                           */
/*          double ident_rate : Rate  of identities                           */
/*          long   score      : Similary Score of blosum                      */
/*          int  compare_mode : Sequence compare mode                         */
/*                                                                            */
/* Output : int : [ 0 : Normal Terminate ]                                    */
/*                                                                            */
/* Replace -------------------------------------------------------------------*/
/*                                                                            */
/* Date   : 2010/09/30                                                        */
/* Author : Akihiro Kashiwagi                                                 */
/* Deteil : Added arguments that is identites count, rate and score           */
/*                                                                            */
/* Date   :                                                                   */
/* Author :                                                                   */
/* Deteil :                                                                   */
/*                                                                            */
/*-------+---------+---------+---------+---------+---------+---------+--------*/
/*3456789012345678901234567890123456789012345678901234567890123456789012345678*/
/******************************************************************************/

int PrintOutForTextViwe(
	char *v,
	char *w,
	char **eg,
	long **ss,
	char **bp,
	char *v_ans,
	char *w_ans,
	char *ans,
	char *eg_arr,
	long *ss_arr,
	char *bp_arr,
	long  inum,
	long  jnum,
	long  vnum,
	long  wnum,
	long  ansnum,
	long  egnum,
	long  ssnum,
	long  bpnum,
	long  v_lc_from,
	long  v_lc_to,
	long  w_lc_from,
	long  w_lc_to,
        long   ident_cnt,
        double ident_rate,
        long  score,
        int   compare_mode
){
	long cnt;				/* Counter                   */
	long i;					/* Loop counter i            */
	long j;					/* Loop counter j            */
	char buf[BUFFER_SIZE];			/* Buffer for sprintf        */
	GtkTextBuffer *textbuf;			/* TextBuffer for answer     */
	GtkTextIter   start;			/* TextIter at start         */
	GtkTextIter   end;			/* TextIter at start         */

						/* Variable for digit        */
	float calc_digit;
						/* Number of digit           */
	int digit_num;
						/* Number of out put textbuf */
	int  put_to;
						/* Number of current         */
	long current_no;
						/* Number of fifth(1/5)      */
	long fifth_num;
						/* Format string             */
						/*           for column no   */
 	char format_str[BUFFER_SIZE];
	
	int disp_flg = ANS_DISP_FLG;
						/* TextBuffer get            */
	textbuf = gtk_text_view_get_buffer( GTK_TEXT_VIEW(textview3) );

						/* TextBuffer clear          */
	gtk_text_buffer_get_start_iter( textbuf, &start );
	gtk_text_buffer_get_end_iter( textbuf, &end );
	gtk_text_buffer_delete( textbuf, &start, &end );

						/* TextBuffer4 clear          */
	gtk_text_buffer_get_start_iter( textbuf4, &start );
	gtk_text_buffer_get_end_iter( textbuf4, &end );
	gtk_text_buffer_delete( textbuf4, &start, &end );

						/* TextBuffer5 clear          */
	gtk_text_buffer_get_start_iter( textbuf5, &start );
	gtk_text_buffer_get_end_iter( textbuf5, &end );
	gtk_text_buffer_delete( textbuf5, &start, &end );

						/* TextBuffer6 clear          */
	gtk_text_buffer_get_start_iter( textbuf6, &start );
	gtk_text_buffer_get_end_iter( textbuf6, &end );
	gtk_text_buffer_delete( textbuf6, &start, &end );

						/* TextBuffer7 clear          */
	gtk_text_buffer_get_start_iter( textbuf7, &start );
	gtk_text_buffer_get_end_iter( textbuf7, &end );
	gtk_text_buffer_delete( textbuf7, &start, &end );

						/* TextBuffer8 clear          */
	gtk_text_buffer_get_start_iter( textbuf8, &start );
	gtk_text_buffer_get_end_iter( textbuf8, &end );
	gtk_text_buffer_delete( textbuf8, &start, &end );

						/* Output of v_ans           */
	if( disp_flg & V_DISP_FLG ){

		for( cnt = vnum - 1; cnt > 0; cnt-- ){
			sprintf(buf,"%c", v_ans[cnt] );
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	
		}
						/* Output of sequence number */
		sprintf(buf,
			",%ld,%ld,%ld,%.2f,%ld\n",
			v_lc_from, v_lc_to, ident_cnt, ident_rate, score / 10
		);
		gtk_text_buffer_insert_at_cursor( textbuf, buf, strlen(buf) );	
	}
						/* Output of bp_arr          */
	if( disp_flg & GAP_DISP_FLG ){
	
		for( cnt = bpnum - 1; cnt > 0; cnt-- ){
			sprintf( buf, "%c", bp_arr[cnt] );
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	
		}
						/* Output LF                 */
		sprintf(buf, "\n");
		gtk_text_buffer_insert_at_cursor( textbuf, buf, strlen(buf) );	
	}
						/* Output of w_ans           */
	if( disp_flg & W_DISP_FLG ){

		for( cnt = wnum - 1; cnt > 0; cnt-- ){
			sprintf( buf, "%c", w_ans[cnt] );
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	
		}
						/* Output of sequence number */
		sprintf(buf,
			",%ld,%ld,%ld,%.2f,%ld\n",
			w_lc_from, w_lc_to, ident_cnt, ident_rate, score / 10
		);
		gtk_text_buffer_insert_at_cursor( textbuf, buf, strlen(buf) );	
	}
						/* Output of ans             */
	if( disp_flg & ANS_DISP_FLG ){

		for( cnt = ansnum - 1; cnt >= 0; cnt-- ){
			put_sequence(
			        textbuf,
			        ans[cnt],
			        eg_arr[cnt] / 10,
			        compare_mode
			);

			if( (cnt % COLUMN_LIMIT) == 0 && (cnt != 0) ){
				put_sequence(
	 				textbuf,
					'\n',
					999,
					compare_mode
				);
			}
		}
						/* Output of sequence number */
		sprintf(buf,
			",%ld,%ld,%ld,%.2f,%ld\n",
			v_lc_from, v_lc_to, ident_cnt, ident_rate, score / 10
		);
		gtk_text_buffer_insert_at_cursor( textbuf, buf, strlen(buf) );

						/* Put identify count         */
		sprintf( buf, "No.%ld-%ld", v_lc_from, v_lc_to );
		gtk_label_set_text( GTK_LABEL(Location_label), buf );

						/* Put identify rate          */
		sprintf(buf,
			"ID %.0f\%(%ld)",
		        ident_rate * 100,
		        ident_cnt
		);
		gtk_label_set_text( GTK_LABEL(Rate_label), buf );
		
						/* Put score                  */
		sprintf( buf, "SCR %ld", score / 10 );
		gtk_label_set_text( GTK_LABEL(Score_label), buf );
	}
						/* Output of EditGraph       */
	if( disp_flg & EG_DISP_FLG ){
						/* Header (w sequence)       */
		sprintf(buf,"v\\w");
		gtk_text_buffer_insert_at_cursor( textbuf, buf, strlen(buf) );	

		for( j = 1; j < jnum - 1; j++ ){
			sprintf(buf,",%c",w[j]);
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	
		}				/* -1 mean footer null       */

		sprintf(buf,"\n");
		gtk_text_buffer_insert_at_cursor( textbuf, buf, strlen(buf) );	

                for( i = 1; i < inum - 1; i++ ){
						/* Header (v sequence)       */
						/* -1 mean footer null       */
			sprintf(buf,"%c",v[i]);
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	

			for( j = 1; j < jnum - 1; j++ ){
         
				sprintf(buf, ",%d",eg[i][j]);
				gtk_text_buffer_insert_at_cursor(
					textbuf, buf, strlen(buf)
				);	
			}
 
			sprintf(buf, "\n");
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	
		}
	}
						/* Output of SimilaryScore   */
	if( disp_flg & SS_DISP_FLG ){
						/* Header (w sequence)       */
		sprintf(buf,"v\\w");
		gtk_text_buffer_insert_at_cursor( textbuf, buf, strlen(buf) );	

		for( j = 1; j < jnum - 1; j++ ){
			sprintf(buf,",%c",w[j]);
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	
		}				/* -1 mean footer null       */

		sprintf(buf,"\n");
		gtk_text_buffer_insert_at_cursor( textbuf, buf, strlen(buf) );	

		for( i = 1; i < inum - 1; i++ ){
						/* Header (v sequence)       */
						/* -1 mean footer null       */
			sprintf(buf,"%c",v[i]);
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	

			for( j = 1; j < jnum - 1; j++ ){
         
				sprintf(buf, ",%ld",ss[i][j]);
				gtk_text_buffer_insert_at_cursor(
					textbuf, buf, strlen(buf)
				);	
			}
 
			sprintf(buf, "\n");
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	
		}
	}
						/* Output of                 */
						/*       BacktrackingPointer */
	if( disp_flg & BP_DISP_FLG ){
						/* Header (w sequence)       */
		sprintf(buf,"v\\w");
		gtk_text_buffer_insert_at_cursor( textbuf, buf, strlen(buf) );	

		for( j = 1; j < jnum - 1; j++ ){
			sprintf(buf,",%c",w[j]);
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	
		}				/* -1 mean footer null       */

		sprintf(buf,"\n");
		gtk_text_buffer_insert_at_cursor( textbuf, buf, strlen(buf) );	

                for( i = 1; i < inum - 1; i++ ){
						/* Header (v sequence)       */
						/* -1 mean footer null       */
			sprintf(buf,"%c",v[i]);
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	
            
			for( j = 1; j < jnum - 1; j++ ){
         
				sprintf(buf, ",%c",bp[i][j]);
				gtk_text_buffer_insert_at_cursor(
					textbuf, buf, strlen(buf)
				);	
			}
 
			sprintf(buf, "\n");
			gtk_text_buffer_insert_at_cursor(
				textbuf, buf, strlen(buf)
			);	
		}
	}

						/* Output of report           */

	digit_num = 0;
	calc_digit = (float)vnum;
	while( calc_digit > 1 ){
		digit_num++;
		calc_digit = calc_digit / 10;
	}
						/* Initialize current number  */
	current_no = 0;
	
						/* Calculate 1/5              */
	fifth_num = (vnum - 1) / 5;

						/* Initialize number          */
						/*     of out put textbuffer  */
	put_to = 3;
						/* Out put loop               */
	for( cnt = vnum - 1; cnt >= 0; cnt--, current_no++ ){

						/* Change to next textbuffer  */
		if( (current_no % fifth_num) == 0 ){
						/* Interval 1/5 times         */

						/* Increment buffer no        */
			put_to++;

			switch( put_to ){
				case 4:
						/* Change to Textbuffer4      */
					textbuf = textbuf4;
					break;
				case 5:
						/* Change to Textbuffer5      */
					textbuf = textbuf5;
					break;
				case 6:
						/* Change to Textbuffer6      */
					textbuf = textbuf6;
					break;
				case 7:
						/* Change to Textbuffer7      */
					textbuf = textbuf7;
					break;
				case 8:
						/* Change to Textbuffer8      */
					textbuf = textbuf8;
					break;
			}
		}

		sprintf( format_str, "%%0%ldld", digit_num );
		sprintf( buf, format_str, current_no );
		gtk_text_buffer_get_end_iter( textbuf, &end );
		gtk_text_buffer_insert_with_tags_by_name(
		        textbuf,
		        &end,
		        buf,
		        strlen(buf),
		        "NUMBER",
		        NULL
		);

						/* Change from '-' to '|'     */
						/*                  in v_ans  */
		if( v_ans[cnt] == '-' ){
			put_sequence(textbuf,'|',        999,compare_mode);
		}else{
			put_sequence(textbuf,v_ans[cnt], 999,compare_mode);
		}
						/* Change from '|' to '-'     */
						/*                  in bp_arr */
		if( bp_arr[cnt] == '|' ){
			put_sequence(textbuf,'-',        999,compare_mode);
		}else{
			put_sequence(textbuf,bp_arr[cnt], 999,compare_mode);
		}
						/* Change from '-' to '|'     */
						/*                  in w_ans  */
		if( w_ans[cnt] == '-' ){
			put_sequence(textbuf,'|',        999,compare_mode);
		}else{
			put_sequence(textbuf,w_ans[cnt], 999,compare_mode);
		}
						/* Output ans                 */
		put_sequence(textbuf,ans[cnt],   999,compare_mode);

						/* Output LF                  */
		put_sequence(textbuf,'\n',       999,compare_mode);
	}

	return(0);
}

/******************************************************************************/
/*                                                                            */
/* Title  : Function of main()                                                */
/* Function Name : main()                                                     */
/*                                                                            */
/* Detail : main                                                              */
/* Date   : 2010/09/16                                                        */
/* Author : Akihiro Kashiwagi                                                 */
/* e-mail : a-kashiwagi@mippi-main.com                                        */
/*                                                                            */
/* Input  : int   argc   : Arguments count                                    */
/*        : char *argv[] : Arguments value                                    */
/* Output : int : return code  NormalTerminate[0]  Error[!=0]                 */
/*                                                                            */
/*                                                                            */
/* Replace -------------------------------------------------------------------*/
/*                                                                            */
/* Date   :                                                                   */
/* Author :                                                                   */
/* Deteil :                                                                   */
/*                                                                            */
/*-------+---------+---------+---------+---------+---------+---------+--------*/
/*3456789012345678901234567890123456789012345678901234567890123456789012345678*/
/******************************************************************************/

int
main (int argc, char *argv[])
{
					/* Pointer of window                  */
 	GtkWidget *window;
					/* Pointer of buffer for textview     */
	GtkTextBuffer *buf;
					/* Return value                       */
	int ret;
					/* General purpose counter            */
	int cnt;

	int output_mode;

#ifdef ENABLE_NLS
	bindtextdomain (GETTEXT_PACKAGE, PACKAGE_LOCALE_DIR);
	bind_textdomain_codeset (GETTEXT_PACKAGE, "UTF-8");
	textdomain (GETTEXT_PACKAGE);
#endif
					/* Set gtk locale                     */
	gtk_set_locale ();
					/* Set default output mode            */
	output_mode = GUI_MODE;
					/* Get arguments                      */
        for( cnt = 0; cnt < argc; cnt++ ){

		if( strcmp( argv[cnt], "-h" ) == 0 ){
					/*                      Help          */
			output_mode = CUI_MODE;
			break;

		}else if( strcmp( argv[cnt], "-cui" ) == 0 ){
					/*                      CUI mode      */
			output_mode = CUI_MODE;
			break;

		}else if( strcmp( argv[cnt], "-gui" ) == 0 ){
					/*                      GUI mode      */
			output_mode = GUI_MODE;
			break;
		}
        }
					/* Mode CUI                           */
	if( output_mode == CUI_MODE ){	
					/* Call to cui_main()                 */
		ret = cui_main( argc, argv );

					/* Check for gtk initialize           */
	}else if( gtk_init_check( &argc, &argv ) == FALSE ){

					/* Call to cui_main()                 */
		ret = cui_main( argc, argv );

	}else{
					/* Mode GUI                           */

					/* Create window                      */
		window = create_window ();
					/* Show window                        */
		gtk_widget_show (window);

					/* Put message to textview1           */
		buf = gtk_text_view_get_buffer(	GTK_TEXT_VIEW(textview1) );
					/* Get pointer of buffer              */
		gtk_text_buffer_set_text(
					/* Set message                        */
		        buf,
		        "Please paste [SOURCE DATA] at this area."\
			" and drag & drop."
		        , -1
		);

					/* Put message to textview2           */
		buf = gtk_text_view_get_buffer(	GTK_TEXT_VIEW(textview2) );
					/* Get pointer of buffer              */
		gtk_text_buffer_set_text(
					/* Set message                        */
		        buf,
		        "Please paste [TARGET DATA] at this area."\
		        " and drag & drop.",
		        -1
		);
					/* Call gtk_main()                    */
		gtk_main ();
					/* Set return value                   */
		ret = 0;
	}
					/* Return                             */
	return( ret );
}
